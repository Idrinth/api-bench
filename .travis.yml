git:
  depth: 3  
cache:
  directories:
  - ~/.composer/cache/
  - ~/.npm
  - ~/.codacy-coverage
branches:
  only:
  - master
jobs:
  include:
  - language: node_js
    node_js: node
    stage: Test
    name: liniting
    install:
    - npm install
    - npm install eslint --global
    script:
    - npm run-script lint
  - language: node_js
    node_js: node
    stage: Test
    name: unittest
    install:
    - npm install
    - npm install coveralls --save-dev
    - npm install ts-node mocha typescript nyc --global
    script:
    - npm run-script test
    after_success:
    - bash <(wget -q -O - https://coverage.codacy.com/get.sh) report -r coverage/lcov.info
    - nyc report --reporter=text-lcov | coveralls 
